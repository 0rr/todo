<section class="todoapp">
	<header class="header">

	</header>

	<section class="main">
		<ul class="todo-list">
<!-- DYNAMICALLY GENERATED SAMPLE HTML
		 	<li>
				<input type="checkbox" name="toggle">
				<label>Do Laundry</label>
			</li> 
-->
		</ul>
	</section>
</section>

<script>
	$(function(){
		$.get("/tasks").success( function ( data ){
			var htmlString = "";

			$.each(data, function(index, task) {
				var checkedStatus = task.done ? "checked" : "";
				var liElement = '<li><div class="view"><input class="toggle" type="checkbox"' + 
				"data-id= '" + task.id + "' " +
				checkedStatus + 
				'><label>' +
				task.title +
				'</label></div></li>';
				htmlString += liElement;
			});
			var ulTodos = $('.todo-list');
			ulTodos.html(htmlString);

			//When an event is fired (triggered), jQuery generally passes the event data (a JavaScript representation of the DOM element that the event is firing for) in a callback
			$('.toggle').change(function(e) {
				var itemId = $(e.target).data("id");
				console.log(itemId);

				var doneValue = Boolean($(e.target).is(':checked'));
				console.log("done:", doneValue);

				$.post("/tasks/" + itemId, {
					_method: "PUT",
					task: {
						done: doneValue
					}
				});

			});
		});
	});
</script>